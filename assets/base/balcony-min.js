/*! caja-kissy  */
(function(){var t=KISSY,n="r4000",e=location&&-1!==(location.search||"").indexOf("caja-debug")?"http://assets.daily.taobao.net/apps/taesite/balcony/core/":"http://a.tbcdn.cn/apps/taesite/balcony/core/",r=e+n+"/caja/";-1!=location.href.indexOf("__dev__")&&(e="../../../caja/ant-lib/com/google/caja/plugin/",n="",r=e);var i="J_TScriptedModule",o={},a={};a.addModsCajoledJS=function(n,e){2>arguments.length||t.isString(n)&&(o[n]=o[n]||";"+e+";")},a.getModsCajoledJS=function(t){return t?o[t]?o[t]:null:null},a.runScriptedMods=function(n,e,r){var a=KISSY.DOM,s=a.query("."+i);if(s){var u=[];t.each(e,function(t){u.push(t(n))});var c=t.isFunction(window.getCajaExposed)?window.getCajaExposed(n,cajaAFTB):{},g=s.length,p=0;t.each(s,function(e){var i=a.attr(e,"data-componentid");if(i){var s=o[i];void 0!==s&&n.makeES5Frame(e,{rewrite:cajaAFTB.rewriteURL},function(i){var o=n.tame(n.markFunction(function(n,e,r){return t.log(n,e,r),!0}));a.attr(i.iframe,"data-modulename",a.attr(i.div,"data-componentid")),cajaAFTB.tameNode||(cajaAFTB.tameNode=function(t){return i.imports.tameNode___(t,!0)},cajaAFTB.checkCss=function(t,n,e){return i.imports.checkCss___(t,n,e)},cajaAFTB.sanitizeHtml=function(t){var n=document.createElement("div");return n=cajaAFTB.tameNode(n),n.innerHTML_s___(t),n.innerHTML_g___()});var l={},h={};t.each(u,function(n){var r=n({frame:i,mod:e});!0===r.kissy?(t.mix(l,r),r.kissy=void 0):t.mix(h,r)});var m=i.contentCajoled("",s),f={KISSY:n.tame(l),onerror:o};f=t.mix(c,f),f=t.mix(f,h),m.run(f,function(){p++,r&&p==g&&r()})})}})}},a.setup=function(t,n){caja.configure({cajaServer:r,debug:location&&-1!==(location.search||"").indexOf("caja-debug")||-1!=location.href.indexOf("__dev__")},function(e){a.runScriptedMods(e,t,n)})},a.registerCajoledMods=function(t,n){a.addModsCajoledJS(t,n)},window.TShop||(window.TShop={}),window.TShop.Balcony=a})();